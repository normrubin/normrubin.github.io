<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.39">

  <title>EECE7398 Fall 2024 – GPU Compilers</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-bbe7401fe57d4b791b917637bb662036.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<meta property="og:title" content="GPU Compilers – EECE7398 Fall 2024">
<meta property="og:site_name" content="EECE7398 Fall 2024">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">GPU Compilers</h1>

<div class="quarto-title-authors">
</div>

</section>
<section id="challenges-in-learning-about-gpus" class="slide level2 scrollable">
<h2>Challenges in Learning About GPUs</h2>
<ol type="1">
<li><strong>Architectural Variations</strong>
<ul>
<li>All the vendors keep changing the architecture. Different vendors build different hardware. Graphics programs run on all vendors’ hardware because vendors ship their own drivers and do finalization on the device.</li>
</ul></li>
<li><strong>Inconsistent Terminology</strong>
<ul>
<li>Vendors use different terms for the same features and reuse CPU terms somewhat differently. For instance, a “Cuda core” is not the same as a ‘CPU core’.</li>
</ul></li>
<li><strong>Legacy Terminology</strong>
<ul>
<li>Some terms come from the GPU’s history of graphics. For example, a shader is a program.</li>
</ul></li>
<li><strong>Software Abstractions</strong>
<ul>
<li>Big frameworks hide the details.</li>
</ul></li>
<li><strong>CUDA’s Market Dominance</strong>
<ul>
<li>Most explanations use CUDA terms since CUDA is the market leader. For instance, AMD uses ‘wave’ to mean more or less the same as a CUDA ‘warp’, but lots of AMD documentation uses ‘warps’.</li>
</ul></li>
<li><strong>CUDA: Language and Model</strong>
<ul>
<li>CUDA is both a programming language and a programming model, so you can have CUDA Fortran, CUDA Python, etc.</li>
</ul></li>
</ol>
</section>
<section id="hardware-styles-nvidia-model" class="slide level2 scrollable">
<h2>hardware styles NVIDIA model</h2>
<ol type="1">
<li>compute and graphics parts have same programmable parts, compute leaves out non-programmable features</li>
<li>graphics customers pay a <strong><em>tax</em></strong> for the compute instructions</li>
<li>more transistors for compute instructions</li>
<li>one big die</li>
</ol>
</section>
<section id="hardware-styles-amd-model" class="slide level2 scrollable">
<h2>hardware styles AMD model</h2>
<ol type="1">
<li>compute has extra instructions (no tax on graphics customers to support compute)</li>
<li>chiplet model (great engineering!)</li>
<li>R series is graphics, C series is compute</li>
</ol>
</section>
<section id="programming-model" class="slide level2">
<h2>programming model</h2>
<p>both vendors use the CUDA programming model. AMD supports a variation of the CUDA language</p>
<p>machines have multiple SIMD processors, each SIMD can be running a different instruction but each <strong><em>lane</em></strong> of a SIMD runs the same instruction</p>
<p>a <strong><em>lane</em></strong> of a SIMD is called a <strong><em>thread</em></strong></p>
</section>
<section class="slide level2">

<p>the programming model is SIMT (single instruction multiple threads)</p>
<p>User writes a scalar program, compiler maps that program to a lane of a SIMD, many instances of the program run at once, hardware combines copies of the scalar program into <strong><em>warps</em></strong>, hardware schedules warps into the SIMD engines</p>
<p>programs are called <strong><em>kernels</em></strong></p>
</section>
<section id="threading-model" class="slide level2">
<h2>threading model</h2>
</section>
<section id="warps-waveswavefronts" class="slide level2 scrollable">
<h2><strong><em>warps/ waves/wavefronts</em></strong></h2>
<ol type="1">
<li>threads are grouped together into <strong><em>warps</em></strong>.</li>
<li>Size is fixed by hardware (usually 32), programmers know this and often make data set sizes a multiple of 32.</li>
<li>since all threads in a warp are running the same instruction, there is no need for explicit synchronization</li>
<li>there are a few instructions that work across a warp, - which break the model and give the compiler problems</li>
</ol>
</section>
<section id="thread-blocks-groups-of-warps" class="slide level2 scrollable">
<h2><strong><em>thread blocks</em></strong> groups of warps,</h2>
<ol type="1">
<li>threads within a block can access a fast scratchpad memory (called shared or LDS) - Violates the C memory model.<br>
</li>
<li>threads are identified by a 3d index inside a block</li>
<li>thread blocks need synchronization operations.<br>
</li>
<li>hardware schedules each block into execution units. Max block size is limited by the size of a execution unit.</li>
</ol>
</section>
<section id="grid-groups-of-blocks" class="slide level2 scrollable">
<h2><strong><em>grid</em></strong> groups of blocks,</h2>
<ol type="1">
<li>3d collection of blocks,</li>
<li>usually hardware limits mean that all the threads in a grid do not run at the same time</li>
<li>programmers need to make grids big enough to fill the hardware</li>
<li>software launches a grid and a program</li>
<li>threads within a grid but in different blocks do not have sync operations</li>
</ol>
</section>
<section id="heterogeneous-programming" class="slide level2">
<h2>Heterogeneous programming</h2>
<p>the cpu is called the <strong><em>host</em></strong></p>
<p>the gpu is called the <strong><em>device</em></strong></p>
<p>cpu launches grids and kernels to gpu</p>
<p>Computations launched on the device execute asynchronously with respect to the host, and it is the user’s responsibility to synchronize</p>
</section>
<section id="memory-spaces" class="slide level2 scrollable">
<h2>memory spaces</h2>
<ol type="1">
<li>cpu and gpu have different memory spaces (cpu can copy from one to the other). Some amount of combined memory (slower then not combined)</li>
<li>gpu has <strong><em>shared/lds</em></strong> memory which can be accessed by threads within a block, passing an address to a different block does not work</li>
<li>main gpu memory is called <strong><em>global</em></strong> accessible by all threads</li>
<li>gpu has per thread memory called <strong><em>local</em></strong> or <strong><em>scratch</em></strong> or <strong><em>private</em></strong> memory - unlike C, passing an address in local memory to another thread does not work. (under some restrictions AMD implements part of the C memory model)</li>
<li>a few special gpu memory types: constant, texture, surface (left over from graphics)</li>
<li>gpu can treat registers as fast memory</li>
</ol>
</section>
<section id="hardware" class="slide level2">
<h2>Hardware</h2>
<p>NVIDIA</p>

<img data-src="images/level0-nv.png" class="r-stretch quarto-figure-center"><p class="caption">nv image level 0</p><p>Each box here is hardware, an int32/fp32/fp64 can perform one operation, so here we have 32 fp32 units which can do 32 float operations in parallel as well as 16 int32 and 16 fp64 units , there are also 8 units can do loads or stores and a final special function unit that can do transcendental operations like sin/cos</p>
<p>under some conditions two instructions (a float and an int) from the same warp can execute at the same time</p>
<p>I’m not going to talk much about the tensor cores</p>
<p>all these units execute the same instruction (SIMT) Simple instruction multiple thread (not the same as SIMD but related )</p>
</section>
<section id="one-instruction-does-vector-work" class="slide level2">
<h2>one instruction does vector work</h2>
<p>add 32 float32 values (all coming from registers) and store the result in 32 other registers</p>
<p>Notice no branch prediction, no out of order execution</p>
<p>great at switching a warp holds the instruction, it knows which registers it owns (continuous set, so it just needs a start and length) switching to a different warp, means changing these two numbers and the pc (this is done by the dispatch unt )</p>
<p>When we do a load, we need to wait for the result. CPU might do some kind of out of order execution, a gpu switches to another warp</p>
<p>finally we need to pick the warp to switch to, this is done by the warp scheduler (half of the hardware scheduler)</p>
</section>
<section id="streaming-multiprocessors-sm" class="slide level2">
<h2>streaming multiprocessors (SM)</h2>
<p>nvidia packs 4 execution engines into a SM (streaming multi-processor) ands an L1 instruction cache, a special memory accelerator for tensors and 256kb l1 data cache/ shared memory block</p>

<img data-src="images/nv-1-sm.bmp" class="r-stretch"></section>
<section id="pack-sms-together" class="slide level2">
<h2>pack sm’s together</h2>

<img data-src="images/nv-sms.jpg" class="r-stretch"></section>
<section id="amd" class="slide level2">
<h2>AMD</h2>
</section>
<section id="and" class="slide level2 scrollable">
<h2>and</h2>

<img data-src="images/amd-compute-unit.jpg" class="r-stretch"><p>AMD has a similar block with some important differences</p>
<ol type="1">
<li>At the bottom of a compute core there are 4 general purpose simd engines each of length 16 and one scalar engine</li>
</ol>
<p>Given 5 waves, this compute core can execute 4 vector instructions and one scalar instruction per clock Two instructions from the same wave never execute at the same time</p>
<p>The SIMD engines can execute different instructions</p>
<p>The simd sizes vary over different chips</p>
</section>
<section id="amd-cdna" class="slide level2">
<h2>amd CDNA</h2>

<img data-src="images/amd-cu.png" class="r-stretch"></section>
<section id="packing-sms" class="slide level2">
<h2>packing sms</h2>

<img data-src="images/cdna2_gcd.png" class="r-stretch"></section>
<section id="simd-and-control-flow" class="slide level2 scrollable">
<h2>simd and control flow</h2>
<p>to execute an if then else</p>
<ol type="1">
<li>compute the if condition</li>
<li>turn off the lanes where the condition is false</li>
<li>execute the if side</li>
<li>flip the lanes</li>
<li>execute the else side</li>
</ol>
<p>time is the sum of the times for then and the else</p>
</section>
<section id="number-of-warps-in-flight" class="slide level2">
<h2>number of warps in flight</h2>
<p>since an entire block has to fit on one compute unit/sm, the resources used in the block limit the number of warps on a sm,</p>
<p>if a warp needs 100 registers and there are 256 vector registers on the compute unit, then two warps can run at once, compiler controls number of registers</p>
</section>
<section id="latency" class="slide level2 scrollable">
<h2>latency</h2>
<p>gpu is a throughput machine- how many threads finish in a unit of time not how long a single thread takes to finish</p>
<p>unlike the cpu, gpu can have lots of loads in flight, time for these loads overlap so compiler tries to group loads together, but this needs extra registers</p>
<ol type="1">
<li>a warp issues a group of loads</li>
<li>warp issues a wait for loads to finish (hardware in cpu, software in gpu)</li>
<li>hardware switches to another warp (if there is on), good to have a lot of warps 1, if all warps waiting for memory, alu units are idle</li>
</ol>
</section>
<section>
<section id="differences" class="title-slide slide level1 center scrollable">
<h1>differences</h1>
<ol type="1">
<li>NVIDA committed to AI, and cut down on the non-tensor operations, AND did not</li>
<li>Generally you need more waves on an AMD processor</li>
<li>AMD added infinity connectors so that they could use chiplets</li>
<li>AMD has a scalar processor - The programming model does not - So its up to the compiler to use it</li>
<li>NVIDIA has 1 architecture for the compiler, AMD has two</li>
</ol>
</section>
<section id="compiler-model" class="slide level2 scrollable">
<h2>compiler model</h2>
<ol type="1">
<li>like a regular compiler for a scalar machine</li>
<li>new problem: registers used in warp limits number of warps in flight, so ra is different</li>
<li>new problem: control flow is more critical</li>
<li>new problem: latency means grouping loads but not to much</li>
<li>new problem: arch keeps changing</li>
</ol>
</section>
<section id="thread-coarsening" class="slide level2">
<h2>thread coarsening</h2>
<p>Suppose we are computing a matrix multiply</p>
<p>we could say each thread writes one result so a 32 x 32 matrix would need 32 * 32 threads each thread reads one column and one row of the input,</p>
<p>we have a lot of reuse (redundant loads of data )</p>
<p>we could say each thread writes 4 results, so we need 1/4 of the threads each thread reads a raw and 4 columns</p>
</section>
<section id="technique" class="slide level2 scrollable">
<h2>technique</h2>
<ol type="1">
<li>merge multiple threads so each resulting thread writes multiple outputs</li>
<li>do the redundant work once and save in registers</li>
<li>use the registers for computing all the outputs</li>
</ol>
<p>But</p>
<ol type="1">
<li>needs extra registers</li>
<li>increased efficiency but reduced parallelism</li>
</ol>
<p>After thread coarsening, computation from merged threads can see each others results</p>
</section>
<section id="doing-this-by-hand" class="slide level2">
<h2>doing this by hand</h2>
<pre><code>for (atomid=0; atomid&lt;numatoms; atomid++) { 
  float dy = coory - atominfo[atomid].y; 
  float dysqpdzsq = (dy * dy) + atominfo[atomid].z; 
  float dx1 = coorx1 - atominfo[atomid].x; 
  float dx2 = coorx2 - atominfo[atomid].x; 
  float dx3 = coorx3 - atominfo[atomid].x; 
  float dx4 = coorx4 - atominfo[atomid].x; 
  energyvalx1 += atominfo[atomid].w * (1.0f / sqrtf(dx1*dx1 + dysqpdzsq));
  energyvalx2 += atominfo[atomid].w * (1.0f / sqrtf(dx2*dx2 + dysqpdzsq)); 
  energyvalx3 += atominfo[atomid].w * (1.0f / sqrtf(dx3*dx3 + dysqpdzsq)); 
  energyvalx4 += atominfo[atomid].w * (1.0f / sqrtf(dx4*dx4 + dysqpdzsq)); } …</code></pre>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/normrubin\.github\.io\/");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>