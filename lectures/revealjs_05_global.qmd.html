<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-29e2c20b02301cfff04dc8050bf30c7e.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.37">

  <title>EECE7398 Fall 2024 – 5 Global Analysis</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-bbe7401fe57d4b791b917637bb662036.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="../site_libs/quarto-diagram/mermaid.min.js"></script>
  <script src="../site_libs/quarto-diagram/mermaid-init.js"></script>
  <link href="../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
<meta property="og:title" content="5 Global Analysis – EECE7398 Fall 2024">
<meta property="og:site_name" content="EECE7398 Fall 2024">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">5 Global Analysis</h1>

<div class="quarto-title-authors">
</div>

</section>
<section id="graph-properties" class="slide level2">
<h2>Graph Properties</h2>
<p>We are going to define assorted graph properties, that can be calculated on cfgs.</p>
</section>
<section id="dominators" class="slide level2 scrollable">
<h2>dominators</h2>
<p>We first define a binary relation on cfg nodes, called <strong><em>dominance</em></strong>. a node d dominates a node i (d dom i) if every possible execution path in the cfg that goes from the entry to i goes through d.&nbsp;</p>
<ol type="1">
<li>Dom is reflexive, so a dom a for all nodes a.</li>
<li>Dom is transitive, a dom b, b dom c ==&gt; a dom c</li>
<li>Dom is anti-symmetric if a dom b, and b dom a then b = a</li>
</ol>
</section>
<section id="dominator-trees" class="slide level2 scrollable">
<h2>dominator trees</h2>
<p>We next define <strong><em>immediate dominators</em></strong> a idom b, a != b and there is no c != a and c != b where a dom c and c dom b.</p>
<ol type="1">
<li>idom is unique</li>
<li>idom forms a tree called the <strong><em>dominator tree</em></strong>, root is the entry of the cfg</li>
</ol>
<p>A <strong><em>strict dominator</em></strong> a sdom b if a dom b and a != b</p>
</section>
<section id="an-example" class="slide level2">
<h2>an example</h2>
<div class="columns">
<div class="column">
<p>A control flow graph</p>
<div class="cell" data-reveal="true" data-layout-align="default">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource default number-lines code-with-copy"><code class="sourceCode default"><span id="cb1-1"><a></a>%%{init: {"flowchart": {"htmlLabels": false}} }%%</span>
<span id="cb1-2"><a></a></span>
<span id="cb1-3"><a></a>graph TD;</span>
<span id="cb1-4"><a></a>n0 --&gt; n1;</span>
<span id="cb1-5"><a></a>n1 --&gt; n2;</span>
<span id="cb1-6"><a></a>n1 --&gt; n3;</span>
<span id="cb1-7"><a></a>n2 --&gt; n4;</span>
<span id="cb1-8"><a></a>n3 --&gt; n4;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">%%{init: {"flowchart": {"htmlLabels": false}} }%%

graph TD;
n0 --&gt; n1;
n1 --&gt; n2;
n1 --&gt; n3;
n2 --&gt; n4;
n3 --&gt; n4;
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div><div class="column">
<p>The dominator tree</p>
<div class="cell" data-reveal="true" data-layout-align="default">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource default number-lines code-with-copy"><code class="sourceCode default"><span id="cb2-1"><a></a>%%{init: {"flowchart": {"htmlLabels": false}} }%%</span>
<span id="cb2-2"><a></a></span>
<span id="cb2-3"><a></a>graph TD;</span>
<span id="cb2-4"><a></a>n0 --&gt; n1;</span>
<span id="cb2-5"><a></a>n1 --&gt; n2;n1 --&gt; n3</span>
<span id="cb2-6"><a></a>n1 --&gt; n4;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">%%{init: {"flowchart": {"htmlLabels": false}} }%%

graph TD;
n0 --&gt; n1;
n1 --&gt; n2;n1 --&gt; n3
n1 --&gt; n4;
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div></div>
</section>
<section>
<section id="another-example" class="title-slide slide level1 center">
<h1>another example</h1>
<div class="columns">
<div class="column">
<p>A control flow graph</p>
<div class="cell" data-reveal="true" data-layout-align="default">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource default number-lines code-with-copy"><code class="sourceCode default"><span id="cb3-1"><a></a>%%{init: {"flowchart": {"htmlLabels": false}} }%%</span>
<span id="cb3-2"><a></a></span>
<span id="cb3-3"><a></a>graph TD;</span>
<span id="cb3-4"><a></a>n1 --&gt; n2;</span>
<span id="cb3-5"><a></a>n2 --&gt; n3;</span>
<span id="cb3-6"><a></a>n2 --&gt; n4; n2--&gt; n6;</span>
<span id="cb3-7"><a></a>n3 --&gt; n5</span>
<span id="cb3-8"><a></a>n4 --&gt; n5</span>
<span id="cb3-9"><a></a>n5 --&gt; n2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">%%{init: {"flowchart": {"htmlLabels": false}} }%%

graph TD;
n1 --&gt; n2;
n2 --&gt; n3;
n2 --&gt; n4; n2--&gt; n6;
n3 --&gt; n5
n4 --&gt; n5
n5 --&gt; n2
 
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div><div class="column">
<p>Dominator tree</p>
<div class="cell" data-reveal="true" data-layout-align="default">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource default number-lines code-with-copy"><code class="sourceCode default"><span id="cb4-1"><a></a>%%{init: {"flowchart": {"htmlLabels": false}} }%%</span>
<span id="cb4-2"><a></a></span>
<span id="cb4-3"><a></a>graph TD;</span>
<span id="cb4-4"><a></a>n1--&gt; n2</span>
<span id="cb4-5"><a></a>n2 --&gt; n3</span>
<span id="cb4-6"><a></a>n2 --&gt; n4</span>
<span id="cb4-7"><a></a>n2--&gt; n5</span>
<span id="cb4-8"><a></a>n2 --&gt; n6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">%%{init: {"flowchart": {"htmlLabels": false}} }%%

graph TD;
n1--&gt; n2
n2 --&gt; n3
n2 --&gt; n4
n2--&gt; n5
n2 --&gt; n6
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div></div>
</section>
<section id="simple-implementation-dominators" class="slide level2">
<h2>simple implementation dominators</h2>
<p><span class="math display">\[
\begin{gathered}
\operatorname{Dom}\left(n_o\right)=\left\{n_o\right\} \\
\operatorname{Dom}(n)=\{n\} \cup\left(\bigcap_{p \in \operatorname{preds}(n)} \operatorname{Dom}(p)\right)
\end{gathered}
\]</span></p>
</section>
<section class="slide level2">

<p>To find the dominators of a node, first put the node itself in the dominators set. Then, take all the common (i.e.&nbsp;intersection) dominators of its predecessors and put them in the set.</p>
<p>What order do we want to process the nodes?</p>
</section>
<section id="pseudo-code" class="slide level2">
<h2>pseudo code</h2>
<p>assume nodes start at 0,</p>
<pre><code>compute_dominators(CFG cfg) {
  cfg[0].dominators = {0}
  for (bb in cfg except 0) {
    b.dominators = {all nodes in cfg}
  }

  do {
    change = false;
    for (bb in cfg except 0) {
      temp = {all nodes in cfg}
      for (pred in bb.predecessors) {
        temp = intersect(temp, pred.dominators)
      }
      temp = union(temp, {bb})
      if (temp != bb.dominators) {
        change = true
        bb.dominators = temp
      }
    }
  } while (change);
}</code></pre>
</section>
<section id="how-do-we-implement-this" class="slide level2">
<h2>How do we implement this</h2>
<p>number the vertices starting at 0, vertices are 0,1,2, number_of_vertices -1 so we could use a bit-vector for the set, and we should process vertices in reverse post order</p>
</section>
<section id="a-faster-way" class="slide level2">
<h2>a faster way</h2>
<p><a href="https://www.cs.tufts.edu/comp/150FP/archive/keith-cooper/dom14.pdf">Cooper, Harvey, Kennedy Algorithm</a></p>
<p>if we have the dominator tree, finding immediate dominators is easy, its the parent of the node Finding dominators is also easy, its all the parents on the path from the entry to the node</p>
<p>suppose we have a node in the cfg with two parents, like n4, if we takes paths backward in the dominator tree the first common ancestor is n1, (the dominator)</p>
</section>
<section id="a-more-complex-example" class="slide level2">
<h2>a more complex example</h2>
<div class="columns">
<div class="column">
<div class="cell" data-reveal="true" data-layout-align="default">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource default number-lines code-with-copy"><code class="sourceCode default"><span id="cb6-1"><a></a>%%{init: {"flowchart": {"htmlLabels": false}} }%%</span>
<span id="cb6-2"><a></a></span>
<span id="cb6-3"><a></a>graph TD;</span>
<span id="cb6-4"><a></a>n0 --&gt; n5;</span>
<span id="cb6-5"><a></a>n0 --&gt; n1;</span>
<span id="cb6-6"><a></a>n5 --&gt; n7;</span>
<span id="cb6-7"><a></a>n5 --&gt; n6;</span>
<span id="cb6-8"><a></a>n1 --&gt; n2 ;</span>
<span id="cb6-9"><a></a>n1 --&gt; n3;</span>
<span id="cb6-10"><a></a>n7 --&gt; n8;</span>
<span id="cb6-11"><a></a>n6 --&gt; n4;</span>
<span id="cb6-12"><a></a>n2 --&gt; n4;</span>
<span id="cb6-13"><a></a>n4 --&gt; n8 ;</span>
<span id="cb6-14"><a></a>n3 --&gt; n8;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">%%{init: {"flowchart": {"htmlLabels": false}} }%%

graph TD;
n0 --&gt; n5;
n0 --&gt; n1;
n5 --&gt; n7;
n5 --&gt; n6;
n1 --&gt; n2 ;
n1 --&gt; n3;
n7 --&gt; n8;
n6 --&gt; n4;
n2 --&gt; n4;
n4 --&gt; n8 ;
n3 --&gt; n8;
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div><div class="column">
<div class="cell" data-reveal="true" data-layout-align="default">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource default number-lines code-with-copy"><code class="sourceCode default"><span id="cb7-1"><a></a>%%{init: {"flowchart": {"htmlLabels": false}} }%%</span>
<span id="cb7-2"><a></a></span>
<span id="cb7-3"><a></a>graph TD;</span>
<span id="cb7-4"><a></a>n0--&gt; n5</span>
<span id="cb7-5"><a></a>n0 --&gt; n1</span>
<span id="cb7-6"><a></a>n5--&gt; n7</span>
<span id="cb7-7"><a></a>n5--&gt; n6</span>
<span id="cb7-8"><a></a>n1--&gt; n2</span>
<span id="cb7-9"><a></a>n1 --&gt; n3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">%%{init: {"flowchart": {"htmlLabels": false}} }%%

graph TD;
n0--&gt; n5
n0 --&gt; n1
n5--&gt; n7
n5--&gt; n6
n1--&gt; n2
n1 --&gt; n3
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p>need n4 and n8</p>
<div class="fragment">
<p>both are dominated by n0</p>
</div>
</div></div>
</section>
<section id="subproblem-find-lowest-common-ancestor-in-dt-of-two-nodes-a-and-b" class="slide level2">
<h2>subproblem: find lowest common ancestor in dt of two nodes a and b</h2>
<p>for each node in the dom tree we have the depth, how far from the root, so if a and b have the same parent, that is the dominator, otherwise move the node with the higher depth up one</p>
<p>a fast way to determine which node is lower keep the nodes in post order, nodes at the top of the cfg have higher numbers</p>
</section>
<section id="part1" class="slide level2">
<h2>part1</h2>
<pre><code>intersect(b1, b2, idoms,postorder_map) {
  while (b1 != b2) {
    if (postorder_map[b1] &lt; postorder_map[b2]) {
      b1 = idoms[b1];
    } else {
      b2 = idoms[b2];
    }
  }
  return b1;</code></pre>
</section>
<section id="pseudo-code-1" class="slide level2">
<h2>pseudo code</h2>
<pre><code>void compute_dominators(CFG cfg) {
  // Some initialization steps and e.g. get postorder.

  // Map its basic block to its postorder traversal.
  foreach (p ; postorder) {
    postorder_map[p] = counter;
    ++counter;
  }

  bool change;
  do {
    change = false;
    foreach_reverse i in postorder) {
      bb = cffg block i 
      new_idom = bb.preds[0];  // Arbitrarily choose the first predecessor

      for pred in preds (bb)) {
        if (cfg.idoms[pred] != CFG.UNDEFINED_IDOM) {
          new_idom = intersect(new_idom, pred, cfg.idoms, postorder_map);
        }
      }
      if (cfg.idoms[i] != new_idom) {
        cfg.idoms[i] = new_idom;
        change = true;
      }
    }
  } while (change);
}

</code></pre>
</section>
<section id="dominator-frontiers" class="slide level2">
<h2>dominator frontiers</h2>
<p>A node A has a <strong><em>dominance frontier</em></strong> which are set of nodes b where A does not dominate b but A dominates a pred of b. Lets see n5 dominance frontier</p>
<p>Finally we have a <strong><em>post dominates</em></strong> b if all paths from b to the exit go through a. for instance n4 post dominates n6.</p>
</section>
<section id="natural-loops" class="slide level2 scrollable">
<h2>natural loops</h2>
<div class="cell" data-reveal="true" data-layout-align="default">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource default number-lines code-with-copy"><code class="sourceCode default"><span id="cb10-1"><a></a>graph TD;</span>
<span id="cb10-2"><a></a>  entry --&gt; loop</span>
<span id="cb10-3"><a></a>  loop --&gt; if </span>
<span id="cb10-4"><a></a>  if --&gt; then</span>
<span id="cb10-5"><a></a>  if --&gt; else</span>
<span id="cb10-6"><a></a>  then --&gt; endif</span>
<span id="cb10-7"><a></a>  else --&gt; endif</span>
<span id="cb10-8"><a></a>  endif --&gt; loop</span>
<span id="cb10-9"><a></a>  loop --&gt; exit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">  graph TD;
  entry --&gt; loop
  loop --&gt; if 
  if --&gt; then
  if --&gt; else
  then --&gt; endif
  else --&gt; endif
  endif --&gt; loop
  loop --&gt; exit
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<ol type="1">
<li>has to have a cycle in cfg (strongly connected)</li>
<li>single entry point (called the <strong>header</strong> ) header</li>
</ol>
</section>
<section id="cycle-but-not-header" class="slide level2">
<h2>cycle but not header</h2>
<p>How about an example that has a cycle and no header</p>
<div class="cell" data-reveal="true" data-layout-align="default">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource default number-lines code-with-copy"><code class="sourceCode default"><span id="cb11-1"><a></a>graph TD;</span>
<span id="cb11-2"><a></a>    entry --&gt; if;</span>
<span id="cb11-3"><a></a>    if --&gt; loop1</span>
<span id="cb11-4"><a></a>    if --&gt; loop2</span>
<span id="cb11-5"><a></a>    loop2 --&gt; loop1</span>
<span id="cb11-6"><a></a>loop1 --&gt; loop2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">    graph TD;
    entry --&gt; if;
    if --&gt; loop1
    if --&gt; loop2
    loop2 --&gt; loop1
loop1 --&gt; loop2
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p>This loop has two entry points.</p>
</section>
<section id="natural-loops-1" class="slide level2 scrollable">
<h2>natural loops</h2>
<p>A <strong><em>back-edge</em></strong> is an edge A-&gt;B, where B dominates A</p>
<p>other edges are forward edges</p>
<p>Natural loops:</p>
<ol type="1">
<li>for a back-edge A-&gt;B, B is the header of the loop</li>
<li>the smallest set of vertices L including A and B, such that for all v in L either preds(v) are in L or v == B</li>
</ol>
</section>
<section id="example" class="slide level2 scrollable">
<h2>example</h2>
<div class="columns">
<div class="column">
<div class="cell" data-reveal="true" data-layout-align="default">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource default number-lines code-with-copy"><code class="sourceCode default"><span id="cb12-1"><a></a>%%{init: {"flowchart": {"htmlLabels": false}} }%%</span>
<span id="cb12-2"><a></a></span>
<span id="cb12-3"><a></a>    graph TD;</span>
<span id="cb12-4"><a></a>    entry --&gt; H1</span>
<span id="cb12-5"><a></a>    H1 --&gt; A</span>
<span id="cb12-6"><a></a>    A --&gt; H2</span>
<span id="cb12-7"><a></a>    H2 --&gt; B</span>
<span id="cb12-8"><a></a>    B --&gt; H2</span>
<span id="cb12-9"><a></a>    B --&gt; H1</span>
<span id="cb12-10"><a></a>    H1 --&gt; exit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">%%{init: {"flowchart": {"htmlLabels": false}} }%%

    graph TD;
    entry --&gt; H1
    H1 --&gt; A
    A --&gt; H2
    H2 --&gt; B
    B --&gt; H2
    B --&gt; H1
    H1 --&gt; exit
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div><div class="column">
<ol type="1">
<li>Backedges B -&gt; H2,</li>
<li>B-&gt; H1</li>
</ol>
<p>for B-&gt; H2, loop is H2,</p>
<p>for B-&gt; H1, loop is H1, A, H2, B</p>
</div></div>
</section>
<section id="reducible-control-flow" class="slide level2">
<h2>reducible control flow</h2>
<p>in a reducible cfg every back edge has a natural loop.</p>
<p>A reducible CFG is one with edges that can be partitioned into two disjoint sets: forward edges, and back edges, such that:</p>
<p>Forward edges form a directed acyclic graph with all nodes reachable from the entry node.</p>
<p>For all back edges (A, B), node B dominates node A.</p>
</section>
<section id="what-is-the-surface-version" class="slide level2">
<h2>what is the surface version</h2>
<p>Structured programming languages are often designed such that all CFGs they produce are reducible, and common structured programming statements such as IF, FOR, WHILE, BREAK, and CONTINUE produce reducible graphs. To produce irreducible graphs, statements such as GOTO are needed. Irreducible graphs may also be produced by some compiler optimizations.</p>
</section>
<section id="t1-and-t2-transforms" class="slide level2">
<h2>t1 and t2 transforms</h2>
<p>Let G be a CFG. Suppose n is a node in G with a self-loop, that is, an edge from n to itself.</p>
<p>Transformation T1: on node n is removal of this self-loop.</p>
<p>Let n1 and n2 be nodes in G such that n2 has the unique direct ancestor n1, and n2 is not the initial node.</p>
<p>transformation T2: on node pair (n1,n2) is merging nodes n1 and n2 into one node,</p>
</section>
<section id="t1-t2" class="slide level2">
<h2>t1 / t2</h2>
<div class="columns">
<div class="column">
<div class="cell" data-reveal="true" data-layout-align="default">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource default number-lines code-with-copy"><code class="sourceCode default"><span id="cb13-1"><a></a>%%{init: {"flowchart": {"htmlLabels": false}} }%%</span>
<span id="cb13-2"><a></a></span>
<span id="cb13-3"><a></a>    graph TD;</span>
<span id="cb13-4"><a></a>    a0[" "] --&gt; n</span>
<span id="cb13-5"><a></a>a1[" "] --&gt; n</span>
<span id="cb13-6"><a></a>n --&gt; n</span>
<span id="cb13-7"><a></a> n --&gt; b[" "]</span>
<span id="cb13-8"><a></a>n --&gt; b1[" "]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">%%{init: {"flowchart": {"htmlLabels": false}} }%%

    graph TD;
    a0[" "] --&gt; n
a1[" "] --&gt; n
n --&gt; n
 n --&gt; b[" "]
n --&gt; b1[" "]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<div class="cell" data-reveal="true" data-layout-align="default">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource default number-lines code-with-copy"><code class="sourceCode default"><span id="cb14-1"><a></a>%%{init: {"flowchart": {"htmlLabels": false}} }%%</span>
<span id="cb14-2"><a></a></span>
<span id="cb14-3"><a></a>    graph TD;</span>
<span id="cb14-4"><a></a>    a0[" "] --&gt; n1</span>
<span id="cb14-5"><a></a>a1[" "] --&gt; n1</span>
<span id="cb14-6"><a></a>n1 --&gt; n2</span>
<span id="cb14-7"><a></a>n2--&gt; n1</span>
<span id="cb14-8"><a></a> n2 --&gt; b[" "]</span>
<span id="cb14-9"><a></a>n2 --&gt; b1[" "]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">%%{init: {"flowchart": {"htmlLabels": false}} }%%

    graph TD;
    a0[" "] --&gt; n1
a1[" "] --&gt; n1
n1 --&gt; n2
n2--&gt; n1
 n2 --&gt; b[" "]
n2 --&gt; b1[" "]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div><div class="column">
<div class="cell" data-reveal="true" data-layout-align="default">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource default number-lines code-with-copy"><code class="sourceCode default"><span id="cb15-1"><a></a>%%{init: {"flowchart": {"htmlLabels": false}} }%%</span>
<span id="cb15-2"><a></a></span>
<span id="cb15-3"><a></a>    graph TD;</span>
<span id="cb15-4"><a></a>    a0[" "] --&gt; n</span>
<span id="cb15-5"><a></a>a1[" "] --&gt; n</span>
<span id="cb15-6"><a></a> n --&gt; b[" "]</span>
<span id="cb15-7"><a></a>n --&gt; b1[" "]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">%%{init: {"flowchart": {"htmlLabels": false}} }%%

    graph TD;
    a0[" "] --&gt; n
a1[" "] --&gt; n
 n --&gt; b[" "]
n --&gt; b1[" "]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<div class="cell" data-reveal="true" data-layout-align="default">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource default number-lines code-with-copy"><code class="sourceCode default"><span id="cb16-1"><a></a>%%{init: {"flowchart": {"htmlLabels": false}} }%%</span>
<span id="cb16-2"><a></a></span>
<span id="cb16-3"><a></a>    graph TD;</span>
<span id="cb16-4"><a></a>    a0[" "] --&gt; n1["n1_n2"]</span>
<span id="cb16-5"><a></a>a1[" "] --&gt; n1</span>
<span id="cb16-6"><a></a> n1 --&gt; b[" "]</span>
<span id="cb16-7"><a></a>n1 --&gt; b1[" "]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">%%{init: {"flowchart": {"htmlLabels": false}} }%%

    graph TD;
    a0[" "] --&gt; n1["n1_n2"]
a1[" "] --&gt; n1
 n1 --&gt; b[" "]
n1 --&gt; b1[" "]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div></div>
</section>
<section id="example-1" class="slide level2">
<h2>example</h2>
<pre><code>int  n = (count + 7) / 8;
switch (count % 8) {
case 0: do { *to = *from++;
case 7:      *to = *from++;
case 6:      *to = *from++;
case 5:      *to = *from++;
case 4:      *to = *from++;
case 3:      *to = *from++;
case 2:      *to = *from++;
case 1:      *to = *from++;
        } while (--n &gt; 0);
}</code></pre>
</section>
<section id="simplified-control-flow" class="slide level2">
<h2>simplified control flow</h2>
<div class="cell" data-reveal="true" data-layout-align="default">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource default number-lines code-with-copy"><code class="sourceCode default"><span id="cb18-1"><a></a>%%{init: {"flowchart": {"htmlLabels": false}} }%%</span>
<span id="cb18-2"><a></a></span>
<span id="cb18-3"><a></a>    graph TD;</span>
<span id="cb18-4"><a></a>    entry --&gt; switch;</span>
<span id="cb18-5"><a></a>    switch --&gt; case0-7</span>
<span id="cb18-6"><a></a>    switch --&gt; case1</span>
<span id="cb18-7"><a></a>    switch --&gt; case2</span>
<span id="cb18-8"><a></a>    case0-7 --&gt; case2</span>
<span id="cb18-9"><a></a>    case2--&gt; case1</span>
<span id="cb18-10"><a></a>    case1 --&gt; dowhile</span>
<span id="cb18-11"><a></a>    dowhile --&gt; case0-7</span>
<span id="cb18-12"><a></a>    dowhile --&gt; exit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">%%{init: {"flowchart": {"htmlLabels": false}} }%%

    graph TD;
    entry --&gt; switch;
    switch --&gt; case0-7
    switch --&gt; case1
    switch --&gt; case2
    case0-7 --&gt; case2
    case2--&gt; case1
    case1 --&gt; dowhile
    dowhile --&gt; case0-7
    dowhile --&gt; exit
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p>not reducible</p>
</section>
<section id="other-optimizations-interactions" class="slide level2">
<h2>other optimizations interactions</h2>
<pre><code>loop: if (cond) goto past_loop
    s1
    call bar()
    goto loop
pastloop:

function bar()
    b1 
    if () return
    b2</code></pre>
</section>
<section id="inline-the-function-combine-jmps-to-jmps" class="slide level2">
<h2>inline the function, combine jmps to jmps</h2>
<div class="columns">
<div class="column">
<pre><code>loop: if (cond) goto past_loop
    s1
    b1
    if () go to next
    b2
    next:
goto loop</code></pre>
</div><div class="column">
<div class="cell" data-reveal="true" data-layout-align="default">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource default number-lines code-with-copy"><code class="sourceCode default"><span id="cb21-1"><a></a>%%{init: {"flowchart": {"htmlLabels": false}} }%%</span>
<span id="cb21-2"><a></a></span>
<span id="cb21-3"><a></a>    graph TD;</span>
<span id="cb21-4"><a></a>    loop--&gt; s1</span>
<span id="cb21-5"><a></a>    loop---&gt; past_loop</span>
<span id="cb21-6"><a></a>    s1--&gt; b1</span>
<span id="cb21-7"><a></a>    b1 --&gt;inline_if</span>
<span id="cb21-8"><a></a>    inline_if --&gt; b2</span>
<span id="cb21-9"><a></a>    b2 --&gt; next_goto</span>
<span id="cb21-10"><a></a>    inline_if --&gt; loop</span>
<span id="cb21-11"><a></a>    next_goto --&gt; loop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">%%{init: {"flowchart": {"htmlLabels": false}} }%%

    graph TD;
    loop--&gt; s1
    loop---&gt; past_loop
    s1--&gt; b1
    b1 --&gt;inline_if
    inline_if --&gt; b2
    b2 --&gt; next_goto
    inline_if --&gt; loop
    next_goto --&gt; loop
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div></div>
<p>Now we have two back edges so two loops</p>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/normrubin\.github\.io\/");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>